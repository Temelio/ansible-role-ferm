table filter {
    chain INPUT {
        # Set the default policy to ACCEPT to avoid getting
        # accidentally locked out.
        policy ACCEPT;

        # Connection tracking.
        mod state state INVALID DROP;
        mod state state (ESTABLISHED RELATED) ACCEPT;

        # Allow local connections.
        interface lo ACCEPT;

        # Respond to ping.
        proto icmp icmp-type echo-request ACCEPT;

        # Allow ssh connections.
        proto tcp dport ssh ACCEPT;

        # include all files in input folder
        @include 'input/';

        # Because the default policy is to ACCEPT we DROP
        # everything that comes through to this stage.
        DROP;
    }

    chain OUTPUT {
        # Outgoing connections are not limited.
        policy ACCEPT;

        # include all files in output folder
        @include 'output/';
    }

    chain FORWARD {
        # Outgoing connections are not limited.
        policy DROP;

        # include all files in forward folder
        @include 'forward/';
    }
}

